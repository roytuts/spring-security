Please follow the tutorial https://roytuts.com/preauthorize-hasrole-security-using-spring-boot-data-jpa/

Spring boot 3 related changes are kept into files which are appended with _3.
